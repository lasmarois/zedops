# M9.8.24: Restore UI for Soft-Deleted Servers

**Status:** ğŸ“‹ PLANNED
**Priority:** MEDIUM
**Category:** UX Enhancement
**References:** Server Lifecycle Management (soft delete system)

---

## Issue

**Observation:** Cannot find the Restore button in the UI for soft-deleted servers.

**Impact:**
- Users cannot restore soft-deleted servers
- Soft delete feature incomplete (delete works, restore doesn't)
- 24-hour retention window not useful without restore capability

---

## Current State

**Soft Delete System (Already Implemented):**
- âœ… DELETE endpoint sets `deleted_at` timestamp and `status='deleted'`
- âœ… Database stores deleted servers for 24 hours
- âœ… Backend has POST `/api/agents/:id/servers/:serverId/restore` endpoint

**Missing:**
- âŒ UI doesn't show deleted servers
- âŒ No "Restore" button visible
- âŒ Users cannot access restore functionality

---

## Investigation Needed

1. **Does ContainerList/ServerList show deleted servers?**
   - Check if deleted servers are filtered out
   - Check if there's a "Show Deleted" toggle

2. **Where should Restore button appear?**
   - In server list (if deleted servers shown)?
   - In a separate "Deleted Servers" section?
   - In a modal/panel?

3. **UX Decision Required:**
   - Should deleted servers be hidden by default?
   - Toggle to show/hide deleted servers?
   - Separate "Trash" or "Deleted" view?
   - Visual distinction (opacity, strikethrough, badge)?

---

## Proposed UX Options

### Option A: Toggle in Server List
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ All Servers                         â”‚
â”‚ [â˜ Show Deleted Servers]            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Name    â”‚ Status   â”‚ Actions        â”‚
â”‚ server1 â”‚ Running  â”‚ [Stop] [Del]   â”‚
â”‚ server2 â”‚ Deleted  â”‚ [Restore] [Purge]â”‚ (only if toggle ON)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Option B: Separate "Deleted Servers" Section
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Active Servers                      â”‚
â”‚ server1 â”‚ Running  â”‚ [Stop] [Del]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Deleted Servers (Kept 24h)          â”‚
â”‚ server2 â”‚ Deleted  â”‚ [Restore] [Purge]â”‚
â”‚   Deleted: 2 hours ago              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Option C: Trash Icon/Badge with Modal
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ All Servers          ğŸ—‘ï¸ (2)         â”‚
â”‚ server1 â”‚ Running  â”‚ [Stop] [Del]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Click trash icon:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Deleted Servers                     â”‚
â”‚ server2 â”‚ Deleted 2h ago           â”‚
â”‚ [Restore] [Purge Now]               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Recommended Approach (Tentative)

**Option B: Separate Section** seems clearest:
- Active servers always visible (primary use case)
- Deleted servers shown below (secondary, occasional use)
- Clear visual separation
- No toggle required (always visible if any deleted)
- Shows time remaining until auto-purge

---

## Implementation Tasks

1. **Check existing code:**
   - Does ContainerList filter out deleted servers?
   - Is restore endpoint already implemented?

2. **Update UI:**
   - Add deleted servers section
   - Add Restore button
   - Add Purge Now button
   - Show time since deletion
   - Show countdown to auto-purge (optional)

3. **Update API hooks:**
   - useRestoreServer hook (may already exist)
   - usePurgeServer hook (may already exist)

4. **Visual design:**
   - Opacity/muted colors for deleted servers
   - Warning badge "Deleted"
   - Clear labels for actions

---

## Success Criteria

- [ ] Deleted servers visible in UI
- [ ] Restore button functional
- [ ] Purge Now button functional
- [ ] Clear UX (users understand restore workflow)
- [ ] Time indicators (deleted X ago, purged in Y hours)
- [ ] Confirmation dialogs for both actions

---

**Next Steps:** Defer until after M9.8.23 purge issue is resolved.
